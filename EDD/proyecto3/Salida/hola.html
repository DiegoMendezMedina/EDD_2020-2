<!DOCTYPE html>
<html>
<head>
	<meta charset='utf-8'>
	<title>hola.txt</title>
	<style>
	.leyendaH {text-align:center;}
	.leyenda  ul {list-style-type:none;padding:0 10px;}
	.leyendaH ul {display:inline-block;}
	.leyenda  ul>li {font-size:14px;}
	.leyendaH ul>li {float:left;margin-right:10px;}
	.leyenda  ul>li>span {width:12px;height:12px;display:inline-block;margin-right:3px;}
	</style>
</head>
<body>

<table class='egt'>
	<tr>
		<th>Palabras :</th>
		<th>Numero de apariciones :</th>
	</tr>
	<tr>
		<td>hola</td>
		<td>9</td>
	<tr>
		<td>de</td>
		<td>4</td>
	<tr>
		<td>fue</td>
		<td>3</td>
	<tr>
		<td>medina</td>
		<td>2</td>
	<tr>
		<td>del</td>
		<td>2</td>
	<tr>
		<td>diego</td>
		<td>2</td>
	<tr>
		<td>mendez</td>
		<td>2</td>
	<tr>
		<td>escritor</td>
		<td>2</td>
	<tr>
		<td>uno</td>
		<td>2</td>
	<tr>
		<td>los</td>
		<td>2</td>
	<tr>
		<td>cuentos</td>
		<td>1</td>
	<tr>
		<td>la</td>
		<td>1</td>
	<tr>
		<td>renovador</td>
		<td>1</td>
	<tr>
		<td>pais</td>
		<td>1</td>
	<tr>
		<td>su</td>
		<td>1</td>
	<tr>
		<td>en</td>
		<td>1</td>
	<tr>
		<td>practicantes</td>
		<td>1</td>
	<tr>
		<td>primeros</td>
		<td>1</td>
	<tr>
		<td>cual</td>
		<td>1</td>
	<tr>
		<td>corto</td>
		<td>1</td>
	<tr>
		<td>relato</td>
		<td>1</td>
	<tr>
		<td>novela</td>
		<td>1</td>
	<tr>
		<td>universales</td>
		<td>1</td>
	<tr>
		<td>maestros</td>
		<td>1</td>
	<tr>
		<td>gotica</td>
		<td>1</td>
	<tr>
		<td>terror</td>
		<td>1</td>
	<tr>
		<td>recordado</td>
		<td>1</td>
	<tr>
		<td>como</td>
		<td>1</td>
	<tr>
		<td>reconocido</td>
		<td>1</td>
	<tr>
		<td>generalmente</td>
		<td>1</td>
	<tr>
		<td>estadounidense</td>
		<td>1</td>
	<tr>
		<td>romantico</td>
		<td>1</td>
	<tr>
		<td>periodista</td>
		<td>1</td>
	<tr>
		<td>y</td>
		<td>1</td>
	<tr>
		<td>critico</td>
		<td>1</td>
	<tr>
		<td>poeta</td>
		<td>1</td>
	<tr>
		<td>un</td>
		<td>1</td>
	<tr>
		<td>wikipedia</td>
		<td>1</td>
	<tr>
		<td>poe</td>
		<td>1</td>
	<tr>
		<td>allan</td>
		<td>1</td>
	<tr>
		<td>edgar</td>
		<td>1</td>
	<tr>
		<td>descripcion</td>
		<td>1</td>
	<tr>
		<td>especialmente</td>
		<td>1</td>
	<tr>
		<td>por</td>
		<td>1</td>
	<tr>
		<td>sus</td>
		<td>1</td>
	<tr>
		<td>llamo</td>
		<td>1</td>
	<tr>
		<td>me</td>
		<td>1</td>
	</table>
<div style='float:left;margin-right:50px;'>
	<canvas id='canvas1'></canvas>
	<div id='leyenda1' class='leyenda'></div>
</div>
<div style='float:left;'>
	<canvas id='canvas2'></canvas>
	<div id='leyenda2' class='leyenda leyendaH'></div>
</div>

<script>
var miPastel=function(canvasId,width,height,valores) {
	this.canvas=document.getElementById(canvasId);
	this.canvas.width=width;
	this.canvas.height=height;
	this.radio=Math.min(this.canvas.width/2,this.canvas.height/2);
	this.context=this.canvas.getContext('2d');
	this.valores=valores;

	this.dibujar=function() {
		this.total=this.getTotal();
		var valor=0;
		var inicioAngulo=0;
		var angulo=0;
		for(var i in this.valores){
			valor=valores[i]['valor'];
			color=valores[i]['color'];
			angulo=2*Math.PI*valor/this.total;
			this.context.fillStyle=color;
			this.context.beginPath();
			this.context.moveTo(this.canvas.width/2, this.canvas.height/2);
			this.context.arc(this.canvas.width/2, this.canvas.height/2, this.radio, inicioAngulo, (inicioAngulo+angulo));
			this.context.closePath();
			this.context.fill();
			inicioAngulo+=angulo;
		}
	}

	this.ponerPorCiento=function(color){
		var valor=0;
		var etiquetaX=0;
		var etiquetaY=0;
		var inicioAngulo=0;
		var angulo=0;
		var texto='';
		var incrementar=0;
		this.context.font='bold 12pt Calibri';
		this.context.fillStyle=color;
		for(var i in this.valores){
			valor=valores[i]['valor'];
			angulo=2*Math.PI*valor/this.total;
			etiquetaX=this.canvas.width/2+(incrementar+this.radio/2)*Math.cos(inicioAngulo+angulo/2);
			etiquetaY=this.canvas.height/2+(incrementar+this.radio/2)*Math.sin(inicioAngulo+angulo/2);
			texto=Math.round(100*valor/this.total);
			if(etiquetaX<this.canvas.width/2)
				etiquetaX-=10;
			this.context.beginPath();
			this.context.fillText(texto+'%', etiquetaX, etiquetaY);
			this.context.stroke();
			inicioAngulo+=angulo;
		}
	}

	this.getTotal=function() {
		var total=0;
		for(var i in this.valores){
			total+=valores[i]['valor'];
		}
		return total;
	}

	this.ponerLeyenda=function(leyendaId) {
		var codigoHTML="<ul class='leyenda'>"
		for(var i in this.valores){
			codigoHTML+="<li><span style='background-color:"+valores[i]['color']+"'></span>" +i+'</li>';
		}
		codigoHTML+='</ul>';
		document.getElementById(leyendaId).innerHTML=codigoHTML;
	}
}

var valores={

	'hola':{valor:13,color:'red'},
	'de':{valor:5,color:'#f44336'},
	'fue':{valor:4,color:'green'},
	'medina':{valor:2,color:'Orange'},
	'del':{valor:2,color:'#00FF00'},
	'diego':{valor:2,color:'#00FFFF'},
	'mendez':{valor:2,color:'#008000'},
	'escritor':{valor:2,color:'#008080'},
	'uno':{valor:2,color:'#000080'},
	'los':{valor:2,color:'#FF00FF'},
	'cuentos':{valor:1,color:'#800080'},
	'la':{valor:1,color:'#800000'},
	'renovador':{valor:1,color:'#FFFF00'},
	'Resto de las palabras':{valor:61,color:'#800080'}
}

var pastel=new miPastel('canvas1',300,300,valores);
pastel.dibujar();
pastel.ponerPorCiento('white');
pastel.ponerLeyenda('leyenda1');
</script>

</body>
</html>